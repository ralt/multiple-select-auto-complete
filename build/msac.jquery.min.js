(function(e){"use strict";function t(t){function n(){function n(n){var a;return r=n.length,r>t.maxItems?(a=t.maxItemsMessage.replace("%d",t.maxItems),s(a),void 0):(e.each(n,function(e){var t=f.clone();e===x&&t.addClass("suggested"),t.data("idx",this),t.text(g[this]).appendTo(l)}),void 0)}function s(n){var s=m.clone();s.text(n),s.insertAfter(d),setTimeout(function(){s.fadeOut(function(){e(this).remove()})},t.flashDelay)}function a(){var t,n=e(this.parentNode),s=n.data("idx");e(this).remove(),t=n.text(),n.remove(),g[s]=t,p[0].options[s].selected=!1}function i(){var t=e("<div></div>",{"class":"msac-wrapper"});d=e("<input />",{type:"text"}),l=e("<div></div>",{"class":"suggestions"}),f=l.clone(),v=f.clone(),d.appendTo(t),l.appendTo(t),f[0].className="suggestion",v[0].className="selection",v.appendTo(t),t.insertAfter(p),h=e("<span></span>",{"class":"delete",html:"&times;"}),m=e("<div></div>",{"class":"flash"})}function o(e){var t,n=e.data("idx");d[0].value="",x=0,delete g[n],e[0].className="selected",t=h.clone(),e.append(t),v.append(e),p[0].options[n].selected=!0,l.children().remove()}function c(t){var n=[],s=t.toLowerCase();return s?e.each(g,function(e){if(this){var t=this.toLowerCase(),a=t.indexOf(s);~a&&n.push(e)}}):x=0,n.length?n:null}var r,u,d,l,f,v,h,m,p=e(this),g=[],x=0;p.hide(),e("option",p).each(function(){g.push(this.text)}),i(),d.on("keyup",function(){var e;l.children().remove(),e=c(this.value),e&&n(e)}),u={13:function(){return o(e(".suggested",l)),x=0,!1},38:function(){return x>0&&x--,!1},40:function(){return r-1>x&&x++,!1}},d.on("keydown",function(e){return u[e.keyCode]?u[e.keyCode]():!0}),l.on("mouseover","div",function(){e(".suggested").removeClass("suggested"),e(this).addClass("suggested")}),l.on("click","div",function(){o(e(this))}),e(".msac-wrapper").on("click",".delete",a)}return t=e.extend({maxItems:20,flashDelay:2e3,maxItemsMessage:"There are more than %d suggestions."},t),n}e.fn.msac=function(e){var n=new t(e);return this.each(n)},e.fn.msac.version="1.0.0"})(jQuery);